<div *ngIf="loading == true" class="loader">Loading..</div>

<div *ngIf="loading == false">
  <p-messages [value]="errors"></p-messages>
  <div *ngIf="loaded">
    <form [formGroup]="businessInducteeForm" (ngSubmit)="onSubmit(businessInducteeForm.value)">
      <p-panel header="Induct {{ personName }} to {{ businessName }}">
        <input id="personId" formControlName="personId" name="personId" type="hidden" class="form-control" [formControl]="businessInducteeForm.controls['personId']"
        />
        <input id="businessId" formControlName="businessId" name="businessId" type="hidden" class="form-control" [formControl]="businessInducteeForm.controls['businessId']"
        />
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">

          <div class="ui-grid-row aed-row">
            <div class="ui-grid-col-2">
              Date Inducted *
            </div>
            <div class="ui-grid-col-6">
              <p-calendar id="inductedDate" formControlName="inductedDate" [showIcon]="true" dateFormat="dd/mm/yy"></p-calendar>
            </div>
            <div class="ui-grid-col-4">
              <div class="ui-message ui-messages-error ui-corner-all" *ngIf="businessInducteeForm.controls['inductedDate'].hasError('required')">
                Date Inducted is required
              </div>
            </div>
          </div>

          <div class="ui-grid-row aed-row">
            <div class="ui-grid-col-2">
              Expiry Date *
            </div>
            <div class="ui-grid-col-6">
              <p-calendar id="expiryDate" formControlName="expiryDate" [showIcon]="true" dateFormat="dd/mm/yy"></p-calendar>
            </div>
            <div class="ui-grid-col-4">
              <div class="ui-message ui-messages-error ui-corner-all" *ngIf="businessInducteeForm.controls['expiryDate'].hasError('required')">
                Expiry Date is required
              </div>
            </div>
          </div>

          <div *ngIf="uploadingFile" class="loader"></div>
          <div *ngIf="showFileUpload()">
            <div class="ui-grid-row aed-row">
              <div class="context-section aedile-datatable">
                <div *ngIf="uploadingFile == false" class="aed-flex">
                  <div class="aed-flex-item">
                    <div>
                      <img style="max-width: 100%; max-height: 100%;" src="{{ businessInductee.absoluteUri }}">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="ui-grid-row aed-row" *ngIf="showFileUpload()">
              <p-fileUpload [style]="{'width':'100%'}" mode="basic" name="inducteeFile" url="{{ uploadFilesUrl }}" accept="image/*" (onError)="onUploadError($event)"
                (onBeforeSend)="onBeforeSend($event)" maxFileSize="5000000" (onUpload)="onUploadFiles($event)" auto="true"
                chooseLabel="Upload Document"></p-fileUpload>
            </div>
          </div>

          <button pButton class="ui-button-info aed-button" type="submit" label="Save" [disabled]="businessInducteeForm.pristine || businessInducteeForm.invalid"></button>
          <button pButton class="ui-button-info aed-button" type="button" (click)="goBack()" label="Cancel"></button>
        </div>
      </p-panel>
    </form>
  </div>
</div>
